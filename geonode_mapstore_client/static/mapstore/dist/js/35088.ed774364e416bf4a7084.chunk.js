(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[35088],{59551:(e,t,r)=>{"use strict";r.d(t,{_b:()=>j,kv:()=>k,ZP:()=>U});var n=r(72500),o=r.n(n),a=r(27361),i=r.n(a),c=r(91175),l=r.n(c),u=r(10928),s=r.n(u),f=r(41106),m=r.n(f),p=r(14293),v=r.n(p),d=r(84596),g=r.n(d),h=r(41609),y=r.n(h),w=r(27418),b=r.n(w),S=r(75875),R=r.n(S),P=r(37275),x=r(86267),O=r(67007);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){var n,o,a;n=e,o=t,a=r[t],(o=function(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===E(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L=function(e){var t=o().parse(e,!0);return o().format(b()({},t,{search:null},{query:b()({service:"CSW",version:"2.0.2"},t.query,{request:void 0})}))},j='<csw:GetRecords xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" xmlns:ogc="http://www.opengis.net/ogc" xmlns:gml="http://www.opengis.net/gml" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dct="http://purl.org/dc/terms/" xmlns:gmd="http://www.isotc211.org/2005/gmd" xmlns:gco="http://www.isotc211.org/2005/gco" xmlns:gmi="http://www.isotc211.org/2005/gmi" xmlns:ows="http://www.opengis.net/ows" service="CSW" version="2.0.2" resultType="results" startPosition="${startPosition}" maxRecords="${maxRecords}"> <csw:Query typeNames="csw:Record"> <csw:ElementSetName>full</csw:ElementSetName> <csw:Constraint version="1.1.0"> <ogc:Filter> ${filterXml} </ogc:Filter> </csw:Constraint> </csw:Query> </csw:GetRecords>',A=function(e,t,r){if(!t.name)return null;switch(e){case"wms":var n=0!==t.value.indexOf("http")?(r&&r.catalogURL||"")+"/"+t.value:t.value;return{type:t.protocol||t.scheme,url:n,SRS:[],params:{name:t.name}};case"arcgis":return{type:"arcgis",url:t.value,SRS:[],params:{name:t.name}};default:return null}},M=[/^OGC:WMS-(.*)-http-get-map/g,/^OGC:WMS/g],D=/serviceType\/ogc\/wms/g,N=M.concat(D),k=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=(null==e?void 0:e.URI)&&g()(e.URI);if(a){var i=l()(a.map((function(e){if(e.protocol){if(M.some((function(t){return e.protocol.match(t)})))return e;if(e.protocol.match(D))return function(e){var t=new Map(Array.from(new URLSearchParams(e.value)).map((function(e){var t=T(e,2),r=t[0],n=t[1];return[r.toLowerCase(),n]}))),r=t.get("layers"),n=t.get("version");return!!r&&I(I({},e),{},{protocol:"OGC:WMS",name:r,value:"".concat(e.value.match(/[^\?]+[\?]+/g),"SERVICE=WMS").concat(n&&"&VERSION=".concat(n))})}(e)}return!1})).filter((function(e){return e})));if(i)return A("wms",i,t)}if(null!=e&&null!==(r=e.references)&&void 0!==r&&r.length){var c=g()(e.references),u=l()(c.filter((function(e){return e.scheme&&M.some((function(t){return e.scheme.match(t)}))})));if(u){var s=o().parse(u.value,!0),f=s.query&&s.query.layers||e.alternative;return A("wms",I(I({},u),{},{name:f}),t)}if(n){var m=l()(c.filter((function(e){return e.scheme&&"WWW:DOWNLOAD-REST_MAP"===e.scheme})));if(m)return A("arcgis",I(I({},m),{},{name:e.alternative}),t)}}return null},q={},W={parseUrl:L,getRecordById:function(e){return new Promise((function(t){Promise.all([r.e(99942),r.e(66372)]).then(function(){t(R().get(e).then((function(e){if(e){var t=r(66372).unmarshaller.unmarshalString(e.data);if(t&&t.name&&"GetRecordByIdResponse"===t.name.localPart&&t.value&&t.value.abstractRecord){var n=t.value.abstractRecord[0].value.dcElement;if(n){for(var o={references:[]},a=0;a<n.length;a++){var i=n[a],c=i.name.localPart,l={};l="references"===c&&i.value?{value:i.value.content&&(0,P.$F)(i.value.content[0])||i.value.content||i.value,scheme:i.value.scheme}:i.value.content&&i.value.content[0]||i.value.content||i.value,o[c]&&Array.isArray(o[c])?o[c].push(l):o[c]?o[c]=[o[c],l]:o[c]=l}return{dc:o}}}else if(t&&t.name&&"ExceptionReport"===t.name.localPart)return{error:t.value.exception&&t.value.exception.length&&t.value.exception[0].exceptionText||"GenericError"};return null}return null})))}.bind(null,r)).catch(r.oe)}))},getRecords:function(e,t,n,o,a){return new Promise((function(c){Promise.all([r.e(99942),r.e(1269)]).then(function(){var u=r(66372),f=u.CSW,p=u.marshaller,d=u.unmarshaller,h=p.marshalString({name:"csw:GetRecords",value:f.getRecords(t,n,"string"!=typeof o&&o)});o&&"string"!=typeof o||(h=function(e,t,r){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).filter,o=(null==n?void 0:n.staticFilter)||"<ogc:Or>\n            <ogc:PropertyIsEqualTo>\n                <ogc:PropertyName>dc:type</ogc:PropertyName>\n                <ogc:Literal>dataset</ogc:Literal>\n            </ogc:PropertyIsEqualTo>\n            <ogc:PropertyIsEqualTo>\n                <ogc:PropertyName>dc:type</ogc:PropertyName>\n                <ogc:Literal>http://purl.org/dc/dcmitype/Dataset</ogc:Literal>\n            </ogc:PropertyIsEqualTo>\n       </ogc:Or>",a="<ogc:And>\n        ".concat(m()((null==n?void 0:n.dynamicFilter)||"<ogc:PropertyIsLike wildCard='%' singleChar='_' escapeChar='\\'><ogc:PropertyName>csw:AnyText</ogc:PropertyName> <ogc:Literal>%${searchText}%</ogc:Literal> </ogc:PropertyIsLike> ")({searchText:r}),"\n        ").concat(o,"\n    </ogc:And>");return m()(j)({filterXml:r?a:o,startPosition:e,maxRecords:t})}(t,n,o,a)),c(R().post(L(e),h,{headers:{"Content-Type":"application/xml"}}).then((function(e){if(e){var t=d.unmarshalString(e.data);if(t&&t.name&&"GetRecordsResponse"===t.name.localPart&&t.value&&t.value.searchResults){var r,n=t.value,o=n.searchResults.abstractRecord||n.searchResults.any,c={numberOfRecordsMatched:n.searchResults.numberOfRecordsMatched,numberOfRecordsReturned:n.searchResults.numberOfRecordsReturned,nextRecord:n.searchResults.nextRecord},u=[];if(o)for(var f=0;f<o.length;f++){var m=o[f].value,p={dateStamp:m.dateStamp&&m.dateStamp.date,fileIdentifier:m.fileIdentifier&&m.fileIdentifier.characterString&&m.fileIdentifier.characterString.value,identificationInfo:m.abstractMDIdentification&&m.abstractMDIdentification.value};if(m.boundingBox){var h,w=void 0;if((h=Array.isArray(m.boundingBox)?l()(m.boundingBox):m.boundingBox)&&h.value){var b,S,R,E,C=null!==(b=null===(S=h.value)||void 0===S?void 0:S.crs)&&void 0!==b?b:"",G=null===(R=C.match(/[\w-]*:[\w-]*:[\w-]*:[\w-]*:[\w-]*:[^:]*:(([\w-]+\s[\w-]+)|[\w-]*)/))||void 0===R?void 0:R[0],L=(0,x.makeNumericEPSG)(null===(E=C.match(/EPSG:[0-9]+/))||void 0===E?void 0:E[0]),j=h.value.lowerCorner,A=h.value.upperCorner,M=L||(0,x.extractCrsFromURN)(G)||s()(C.split(":"));"EPSG:4326"===(M?"EPSG:"===M.slice(0,5)?(0,x.makeNumericEPSG)(M):(0,x.makeNumericEPSG)("EPSG:".concat(M)):"EPSG:4326")&&"CRS84"!==M&&"OGC:CRS84"!==M&&(j=[j[1],j[0]],A=[A[1],A[0]]),w=(0,x.makeBboxFromOWS)(j,A)}p.boundingBox={extent:w,crs:"EPSG:4326"}}var D=m.dcElement;if(D){for(var W={references:[]},U=0;U<D.length;U++){var F=D[U],B=F.name.localPart,$={};$="references"===B&&F.value?{value:F.value.content&&(0,P.$F)(F.value.content[0])||F.value.content||F.value,scheme:F.value.scheme}:F.value.content&&F.value.content[0]||F.value.content||F.value,W[B]&&Array.isArray(W[B])?W[B].push($):W[B]?W[B]=[W[B],$]:W[B]=$}var _=g()(W.references.length>0?W.references:W.URI);r=r?r.concat(_):_,p.dc=W}u.push(p)}return c.records=u,function(e,t,r){if(!i()(r,"options.service.autoSetVisibilityLimits",!1))return t;var n=((null==e?void 0:e.find((function(e){return N.some((function(t){var r,n;return(null==e||null===(r=e.scheme)||void 0===r?void 0:r.match(t))||(null==e||null===(n=e.protocol)||void 0===n?void 0:n.match(t))}))})))||{}).value,o=T(n&&n.split("?")||[],1)[0];if(!o)return I({},t);var a=q[o],c=!y()(a);return Promise.resolve(c?a:O.ZP.getCapabilities(o+"?version=").then((function(e){return i()(e,"capability.layer.layer",[])})).catch((function(){return[]}))).then((function(e){var r;return c||(q[o]=e),I(I({},t),{},{records:null==t||null===(r=t.records)||void 0===r?void 0:r.map((function(t){var r=i()(k(null==t?void 0:t.dc,null,!1),"params.name",""),n=e.find((function(e){return e.name===r}))||{},o=n.minScaleDenominator,a=n.maxScaleDenominator;return I(I({},t),(!v()(o)||!v()(a))&&{capabilities:{MaxScaleDenominator:a,MinScaleDenominator:o}})}))})}))}(r,c,a)}if(t&&t.name&&"ExceptionReport"===t.name.localPart)return{error:t.value.exception&&t.value.exception.length&&t.value.exception[0].exceptionText||"GenericError"}}return null})))}.bind(null,r)).catch(r.oe)}))},textSearch:function(e,t,r,n,o){return new Promise((function(a){a(W.getRecords(e,t,r,n,o))}))},workspaceSearch:function(e,t,n,o,a){return new Promise((function(i){Promise.all([r.e(99942),r.e(1269)]).then(function(){var c=r(84454).Filter,l=a||"%",u=o&&"%"+o+"%"||"%",s=c.propertyIsLike("dc:identifier",l+":"+u),f=c.filter(s);i(W.getRecords(e,t,n,f))}.bind(null,r)).catch(r.oe)}))},reset:function(){}};const U=W},3475:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b});var n=r(75875),o=r.n(n),a=r(37275),i=r(72500),c=r.n(i),l=r(27418),u=r.n(l),s=r(5055),f=r.n(s),m=r(84596),p=r.n(m),v=r(86267),d=r(7294),g={},h=function(e){var t=c().parse(e,!0);return c().format(u()({},t,{search:null},{query:u()({SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:"GetCapabilities"},t.query)}))},y=function(e,t,r,n,o){for(var a=e.Capabilities.Contents,i=(0,d.G6)(e),c=(0,d.s5)(e),l=a.TileMatrixSet&&p()(a.TileMatrixSet)||[],s=[],f=l.length,m=0;m<f;m++)s.push((0,v.getEPSGCode)(l[m]["ows:SupportedCRS"]));var g=a.Layer,h=p()(g).filter((function(e){return!n||-1!==e["ows:Identifier"].toLowerCase().indexOf(n.toLowerCase())||e["ows:Title"]&&-1!==e["ows:Title"].toLowerCase().indexOf(n.toLowerCase())}));return{numberOfRecordsMatched:h.length,numberOfRecordsReturned:Math.min(r,h.length),nextRecord:t+Math.min(r,h.length)+1,records:h.filter((function(e,n){return n>=t-1&&n<t-1+r})).map((function(e){return u()({},e,{SRS:s,TileMatrixSet:l,queryable:!!(0,d.b4)(i,"GetFeatureInfo","KVP"),requestEncoding:c,style:(0,d.EN)(e),format:(0,d.JY)(e),GetTileURL:(0,d.b4)(i,"GetTile",c),capabilitiesURL:o})}))}},w={parseUrl:h,getRecords:function(e,t,r,n){var i=g[e];return i&&(new Date).getTime()<i.timestamp+1e3*((0,a.u8)("cacheExpire")||60)?new Promise((function(o){o(y(i.data,t,r,n,e))})):o().get(h(e)).then((function(o){var a;return f().parseString(o.data,{explicitArray:!1},(function(e,t){a=t})),g[e]={timestamp:(new Date).getTime(),data:a},y(a,t,r,n,e)}))},getCapabilities:function(e){var t=g[e];return t&&(new Date).getTime()<t.timestamp+1e3*((0,a.u8)("cacheExpire")||60)?new Promise((function(e){e(t.data)})):o().get(h(e)).then((function(t){var r;return f().parseString(t.data,{explicitArray:!1},(function(e,t){r=t})),g[e]={timestamp:(new Date).getTime(),data:r},r}))},textSearch:function(e,t,r,n){return w.getRecords(e,t,r,n)},reset:function(){Object.keys(g).forEach((function(e){delete g[e]}))}};const b=w}}]);